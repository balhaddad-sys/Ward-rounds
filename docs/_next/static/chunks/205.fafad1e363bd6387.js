"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[205],{1205:function(e,t,o){async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"lab";try{console.log("[Google Script Flow] Using local OCR + Google Script AI...");let{processDocument:n}=await Promise.all([o.e(960),o.e(859)]).then(o.bind(o,2859)),a=await n(e,e.type,t);console.log("[Google Script Flow] OCR complete. Sending to Google Script for AI analysis...");let r={action:"interpret",documentType:t,text:a.fullText,metadata:{confidence:a.confidence,fileName:e.name}},i=await fetch("https://script.google.com/macros/s/AKfycbz5I5uGmK3f-_k7pi9HMsW1YMANS8NGnC8-kIDxcEB1vesYXpmwNHRnQRGX_GqV19iWJw/exec",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!i.ok)throw Error("Google Script returned ".concat(i.status));let c=await i.json();if(!c.success)throw Error(c.error||"AI processing failed");let{generatePresentation:l}=await o.e(621).then(o.bind(o,1621)),s=l({reportType:t,extractedText:a.fullText,ocrConfidence:a.confidence,structuredData:a.structuredData,interpretation:c.interpretation,clinicalPearls:c.clinicalPearls,potentialQuestions:c.potentialQuestions});return{success:!0,report:{id:Date.now().toString(),type:t,fileName:e.name,extractedText:a.fullText,ocrConfidence:a.confidence,structuredData:a.structuredData,interpretation:c.interpretation,clinicalPearls:c.clinicalPearls,potentialQuestions:c.potentialQuestions,presentation:s,source:"google_script",createdAt:new Date().toISOString()}}}catch(e){throw console.error("[Google Script Flow] Error in local OCR flow:",e),e}}async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"lab";if("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname){console.log("[Auto] Using local API (development mode)");try{let o=localStorage.getItem("medward_token");if(!o)throw Error("No auth token");let n=new FormData;n.append("document",e),n.append("reportType",t);let a=await fetch("/api/documents/upload",{method:"POST",headers:{Authorization:"Bearer ".concat(o)},body:n});if(a.ok)return await a.json();throw Error("Local API failed")}catch(e){console.warn("[Auto] Local API failed, falling back to Google Script")}}return console.log("[Auto] Using Google Script (production mode)"),await n(e,t)}o.d(t,{processDocumentAuto:function(){return a}})}}]);