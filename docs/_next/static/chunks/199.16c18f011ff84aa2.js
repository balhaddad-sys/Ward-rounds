"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[199],{8199:function(e,t,o){o.d(t,{interpretWithGoogleScript:function(){return n},saveReportToSheets:function(){return i}});let r="https://script.google.com/macros/s/AKfycbz5I5uGmK3f-_k7pi9HMsW1YMANS8NGnC8-kIDxcEB1vesYXpmwNHRnQRGX_GqV19iWJw/exec";async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"general";try{var o;console.log("[Google Script] Sending request...");let n={action:"interpret",documentType:t,text:e.rawText||e.text,metadata:{confidence:e.confidence,fileName:null===(o=e.metadata)||void 0===o?void 0:o.fileName,extractedAt:new Date().toISOString()}},i=await fetch(r,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!i.ok)throw Error("Google Script returned ".concat(i.status,": ").concat(i.statusText));let c=await i.json();return console.log("[Google Script] Response received:",c),c}catch(e){throw console.error("[Google Script] Error:",e),e}}async function i(e){try{console.log("[Google Script] Saving to Google Sheets...");let t={action:"saveReport",report:{id:e.id,title:e.title,type:e.type,patientName:e.patientName,patientMrn:e.patientMrn,extractedText:e.extractedText,ocrConfidence:e.ocrConfidence,interpretation:e.interpretation,date:e.date}},o=await fetch(r,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!o.ok)throw Error("Google Script returned ".concat(o.status));let n=await o.json();return console.log("[Google Script] Report saved to Sheets"),n}catch(e){throw console.error("[Google Script] Error saving to Sheets:",e),e}}}}]);