"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[859],{2859:function(e,t,n){n.d(t,{processDocument:function(){return o}});var i=n(9960);async function s(e){try{var t,n;console.log("[OCR] Starting text extraction...");let s=await (0,i.createWorker)("eng",1,{logger:e=>{"recognizing text"===e.status&&console.log("[OCR] Progress: ".concat(Math.round(100*e.progress),"%"))}}),{data:o}=await s.recognize(e);return await s.terminate(),console.log("[OCR] Extraction complete"),console.log("[OCR] Confidence: ".concat(o.confidence,"%")),{text:o.text,confidence:o.confidence/100,words:(null===(t=o.words)||void 0===t?void 0:t.length)||0,lines:(null===(n=o.lines)||void 0===n?void 0:n.length)||0}}catch(e){throw console.error("[OCR] Error:",e),Error("Failed to extract text: ".concat(e.message))}}async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"general";if(console.log("[OCR] Processing ".concat(t," document...")),"application/pdf"===e.type)return{text:"[PDF processing not yet implemented - please use images]",confidence:0,type:t,error:"PDF processing requires additional setup"};let n=await s(e),i=function(e,t){let n=e.split("\n").filter(e=>e.trim());switch(t){case"lab":return function(e){let t=[],n=/([A-Za-z\s]+)\s*[:-]?\s*([\d.]+)\s*([a-zA-Z/%]+)?/;return e.forEach(e=>{let i=e.match(n);i&&t.push({test:i[1].trim(),value:i[2],unit:i[3]||"",raw:e})}),{type:"lab",results:t,totalTests:t.length}}(n);case"imaging":let i,s,o,r;return i=[],s="",o=!1,r=!1,n.forEach(e=>{let t=e.toLowerCase();t.includes("findings")||t.includes("technique")?(o=!0,r=!1):t.includes("impression")||t.includes("conclusion")?(r=!0,o=!1):o&&e.trim()?i.push(e.trim()):r&&e.trim()&&(s+=e.trim()+" ")}),{type:"imaging",findings:i,impression:s.trim(),lineCount:n.length};case"note":return function(e){let t={subjective:[],objective:[],assessment:[],plan:[]},n=null;return e.forEach(e=>{let i=e.toLowerCase();i.includes("subjective")||i.includes("history")?n="subjective":i.includes("objective")||i.includes("physical exam")?n="objective":i.includes("assessment")||i.includes("diagnosis")?n="assessment":i.includes("plan")||i.includes("treatment")?n="plan":n&&e.trim()&&t[n].push(e.trim())}),{type:"note",sections:t,format:"SOAP"}}(n);default:return{lines:n,summary:e.substring(0,200)}}}(n.text,t);return{rawText:n.text,confidence:n.confidence,type:t,parsed:i,metadata:{fileName:e.name,fileSize:e.size,fileType:e.type,extractedAt:new Date().toISOString()}}}}}]);