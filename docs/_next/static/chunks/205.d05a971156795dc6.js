"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[205],{1205:function(t,e,o){async function n(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"lab";try{console.log("[Google Script Flow] Using local OCR + Google Script AI...");let{processDocument:n}=await Promise.all([o.e(960),o.e(859)]).then(o.bind(o,2859)),a=await n(t,t.type,e);console.log("[Google Script Flow] OCR complete. Sending to Google Script for AI analysis...");let r={action:"interpret",documentType:e,text:a.fullText,metadata:{confidence:a.confidence,fileName:t.name}},i=await fetch("https://script.google.com/macros/s/AKfycbwWYEiLB0bdOfLt9bSizC9vLL0a-Zut52DqSjNgd6roAk7sdQ8cI0MzHsP2mk66JwK5/exec",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!i.ok)throw Error("Google Script returned ".concat(i.status));let c=await i.json();if(!c.success)throw Error(c.error||"AI processing failed");let{generatePresentation:l}=await o.e(621).then(o.bind(o,1621)),s=l({reportType:e,extractedText:a.fullText,ocrConfidence:a.confidence,structuredData:a.structuredData,interpretation:c.interpretation,clinicalPearls:c.clinicalPearls,potentialQuestions:c.potentialQuestions});return{success:!0,report:{id:Date.now().toString(),type:e,fileName:t.name,extractedText:a.fullText,ocrConfidence:a.confidence,structuredData:a.structuredData,interpretation:c.interpretation,clinicalPearls:c.clinicalPearls,potentialQuestions:c.potentialQuestions,presentation:s,source:"google_script",createdAt:new Date().toISOString()}}}catch(t){throw console.error("[Google Script Flow] Error in local OCR flow:",t),t}}async function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"lab";if("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname){console.log("[Auto] Using local API (development mode)");try{let o=localStorage.getItem("medward_token");if(!o)throw Error("No auth token");let n=new FormData;n.append("document",t),n.append("reportType",e);let a=await fetch("/api/documents/upload",{method:"POST",headers:{Authorization:"Bearer ".concat(o)},body:n});if(a.ok)return await a.json();throw Error("Local API failed")}catch(t){console.warn("[Auto] Local API failed, falling back to Google Script")}}return console.log("[Auto] Using Google Script (production mode)"),await n(t,e)}o.d(e,{processDocumentAuto:function(){return a}})}}]);