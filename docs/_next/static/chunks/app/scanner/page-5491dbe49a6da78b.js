(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[673],{7900:function(e,t,s){Promise.resolve().then(s.bind(s,7190))},7190:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var a=s(7437),l=s(2265),r=s(9376),n=s(166),i=s(5725);let o=(0,n.default)(()=>s.e(785).then(s.t.bind(s,4785,23)),{loadableGenerated:{webpack:()=>[4785]},ssr:!1});function c(e){let{onCapture:t}=e,[s,r]=(0,l.useState)("camera"),[n,c]=(0,l.useState)(!1),[d,u]=(0,l.useState)(null),x=(0,l.useRef)(null),m=(0,l.useCallback)(async()=>{if(x.current){c(!0);try{let e=x.current.getScreenshot({width:1920,height:1080});if(!e)throw Error("Failed to capture image");let s=await fetch(e),a=await s.blob(),l=new File([a],"scan-".concat(Date.now(),".jpg"),{type:"image/jpeg"});t(l,"camera")}catch(e){console.error("Capture error:",e),alert("Failed to capture photo. Please try again.")}finally{c(!1)}}},[t]),p=(0,l.useCallback)(e=>{e[0]&&t(e[0],"upload")},[t]),{getRootProps:b,getInputProps:h,isDragActive:f}=(0,i.uI)({onDrop:p,accept:{"image/*":[".jpeg",".jpg",".png"],"application/pdf":[".pdf"]},maxFiles:1,multiple:!1});return(0,a.jsxs)("div",{className:"flex flex-col h-full bg-slate-900",children:[(0,a.jsxs)("div",{className:"flex gap-2 p-4 bg-slate-800",children:[(0,a.jsx)("button",{onClick:()=>r("camera"),className:"flex-1 py-3 rounded-xl font-medium transition-colors ".concat("camera"===s?"bg-blue-600 text-white":"bg-slate-700 text-slate-300"),children:"\uD83D\uDCF7 Camera"}),(0,a.jsx)("button",{onClick:()=>r("upload"),className:"flex-1 py-3 rounded-xl font-medium transition-colors ".concat("upload"===s?"bg-blue-600 text-white":"bg-slate-700 text-slate-300"),children:"\uD83D\uDCC1 Upload"})]}),"camera"===s?(0,a.jsx)("div",{className:"relative flex-1 bg-black",children:d?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-white p-8",children:[(0,a.jsx)("span",{className:"text-6xl mb-4",children:"\uD83D\uDCF7"}),(0,a.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Camera Access Needed"}),(0,a.jsx)("p",{className:"text-sm text-slate-400 text-center mb-4",children:d}),(0,a.jsx)("button",{onClick:()=>r("upload"),className:"px-6 py-3 bg-blue-600 text-white rounded-xl font-medium",children:"Use File Upload Instead"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o,{ref:x,audio:!1,screenshotFormat:"image/jpeg",screenshotQuality:.95,videoConstraints:{facingMode:{ideal:"environment"},width:{ideal:1920},height:{ideal:1080}},className:"w-full h-full object-cover",onUserMediaError:e=>{console.error("Camera error:",e),u("Unable to access camera. Please check permissions or use file upload.")}}),(0,a.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:(0,a.jsxs)("div",{className:"absolute inset-8 border-2 border-white/50 rounded-lg",children:[(0,a.jsx)("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 text-white text-sm bg-black/70 px-3 py-1 rounded-full whitespace-nowrap",children:"Align document within frame"}),(0,a.jsx)("div",{className:"absolute -top-1 -left-1 w-6 h-6 border-t-4 border-l-4 border-blue-500"}),(0,a.jsx)("div",{className:"absolute -top-1 -right-1 w-6 h-6 border-t-4 border-r-4 border-blue-500"}),(0,a.jsx)("div",{className:"absolute -bottom-1 -left-1 w-6 h-6 border-b-4 border-l-4 border-blue-500"}),(0,a.jsx)("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 border-b-4 border-r-4 border-blue-500"})]})}),(0,a.jsxs)("div",{className:"absolute bottom-8 left-0 right-0 flex justify-center gap-4 items-center",children:[(0,a.jsx)("button",{className:"w-12 h-12 rounded-full bg-slate-800/80 backdrop-blur flex items-center justify-center text-white",children:"⚡"}),(0,a.jsx)("button",{onClick:m,disabled:n,className:"w-20 h-20 rounded-full bg-white border-4 border-blue-600 flex items-center justify-center shadow-2xl active:scale-95 transition-transform disabled:opacity-50",children:n?(0,a.jsx)("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"}):(0,a.jsx)("div",{className:"w-14 h-14 rounded-full bg-blue-600"})}),(0,a.jsx)("button",{onClick:()=>r("upload"),className:"w-12 h-12 rounded-full bg-slate-800/80 backdrop-blur flex items-center justify-center text-white",children:"\uD83D\uDDBC️"})]})]})}):(0,a.jsxs)("div",{...b(),className:"flex-1 flex flex-col items-center justify-center p-8 transition-colors ".concat(f?"bg-blue-900/20 border-2 border-blue-500 border-dashed":"bg-slate-800"),children:[(0,a.jsx)("input",{...h()}),(0,a.jsx)("div",{className:"w-32 h-32 rounded-full bg-slate-700 flex items-center justify-center mb-6",children:(0,a.jsx)("span",{className:"text-6xl",children:f?"\uD83D\uDCE5":"\uD83D\uDCC4"})}),(0,a.jsx)("h3",{className:"text-2xl font-semibold text-white mb-2",children:f?"Drop file here":"Upload Document"}),(0,a.jsx)("p",{className:"text-slate-400 text-center mb-6",children:f?"Release to upload":(0,a.jsxs)(a.Fragment,{children:["Tap to select or drag and drop",(0,a.jsx)("br",{}),"Supports: JPG, PNG, PDF (up to 10MB)"]})}),(0,a.jsxs)("div",{className:"flex gap-3 text-sm text-slate-500",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{children:"✓"})," Lab Reports"]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{children:"✓"})," X-rays"]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{children:"✓"})," CT/MRI"]})]})]})]})}function d(){let[e,t]=(0,l.useState)(!1),[n,i]=(0,l.useState)(!1);(0,r.useRouter)();let o=async(e,a)=>{t(!0),i(!1);try{console.log("[Scanner] Starting OCR extraction...");let{processDocument:t}=await Promise.all([s.e(960),s.e(859)]).then(s.bind(s,2859)),l=e.type.includes("pdf")?"general":"lab",r=await t(e,l);console.log("[Scanner] OCR complete, confidence:",r.confidence),console.log("[Scanner] Interpreting document...");let{interpretDocument:n}=await s.e(516).then(s.bind(s,2516)),o=await n(r);console.log("[Scanner] Interpretation complete"),console.log("[Scanner] Generating presentation...");let{generatePresentation:c}=await s.e(621).then(s.bind(s,1621)),d=c(o,{age:"XX",gender:"unknown",chiefComplaint:"presenting"},r);console.log("[Scanner] Presentation generated");let u=JSON.parse(localStorage.getItem("medward_reports")||"[]"),x={id:Date.now(),type:l,title:e.name,fileName:e.name,fileSize:e.size,fileType:e.type,uploadMethod:a,date:new Date().toISOString(),status:"analyzed",patientName:"New Patient",patientMrn:"TBD",extractedText:r.rawText,ocrConfidence:r.confidence,interpretation:o,presentation:d.presentation,clinicalPearls:d.clinicalPearls,potentialQuestions:d.potentialQuestions};u.unshift(x),localStorage.setItem("medward_reports",JSON.stringify(u)),console.log("[Scanner] Report saved successfully"),i(!0),setTimeout(()=>{window.location.href="/Ward-rounds/reports/view/?id=".concat(x.id)},2e3)}catch(e){console.error("[Scanner] Error:",e),alert("Failed to process report: ".concat(e.message))}finally{t(!1)}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:[(0,a.jsx)("header",{className:"bg-white/80 backdrop-blur-lg border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("button",{onClick:()=>window.location.href="/Ward-rounds/dashboard/",className:"text-gray-600 hover:text-gray-900 transition-colors",children:"← Back"}),(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center shadow-lg",children:(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCF7"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Scan Report"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Upload medical documents for analysis"})]})]})})})}),(0,a.jsxs)("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsx)("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:e?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center p-12",children:[(0,a.jsx)("div",{className:"w-16 h-16 border-4 border-primary/30 border-t-primary rounded-full animate-spin mb-4"}),(0,a.jsx)("p",{className:"text-gray-600 font-medium",children:"Uploading report..."})]}):n?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center p-12",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4",children:(0,a.jsx)("span",{className:"text-4xl",children:"✅"})}),(0,a.jsx)("p",{className:"text-gray-900 font-bold text-xl mb-2",children:"Upload Successful!"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Redirecting to reports..."})]}):(0,a.jsx)(c,{onCapture:o})}),(0,a.jsx)("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-xl p-4",children:(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("span",{className:"text-xl",children:"\uD83D\uDCA1"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 mb-1",children:"Supported Formats"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"You can upload lab results, imaging reports, discharge summaries, and other medical documents. Supported formats: JPG, PNG, PDF (up to 10MB)"})]})]})})]})]})}}},function(e){e.O(0,[46,971,117,744],function(){return e(e.s=7900)}),_N_E=e.O()}]);