"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[205],{1205:function(e,t,o){async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"lab";console.log("[GoogleScript] Processing document...");try{let o=await new Promise((t,o)=>{let n=new FileReader;n.onload=()=>{t(n.result.split(",")[1])},n.onerror=o,n.readAsDataURL(e)}),n={action:"processDocument",documentType:t,fileName:e.name,fileType:e.type,fileSize:e.size,fileData:o},c=await r(n);if(!c||!c.success)throw Error((null==c?void 0:c.error)||"Processing failed");return{success:!0,report:{id:c.reportId||Date.now().toString(),type:t,fileName:e.name,extractedText:c.extractedText||"",ocrConfidence:c.ocrConfidence||.7,interpretation:c.interpretation||{},clinicalPearls:c.clinicalPearls||{pearls:[]},potentialQuestions:c.potentialQuestions||{questions:[]},presentation:c.presentation||{},createdAt:new Date().toISOString()}}}catch(e){throw console.error("[GoogleScript] Error:",e),e}}async function r(e){let t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;for(let n=1;n<=o;n++)try{console.log("[GoogleScript] Attempt ".concat(n,"/").concat(o,"..."));let t=await fetch("https://script.google.com/macros/s/AKfycbxJfUS-CHHi3I9zq5f2WTtaK4s0fqNRM3_FZejsoGDwKL9I4fqdn_P-RKZFIsvw-8PiqA/exec",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("HTTP ".concat(t.status,": ").concat(t.statusText));let r=await t.json();return console.log("[GoogleScript] Success!"),r}catch(e){if(t=e,console.warn("[GoogleScript] Attempt ".concat(n," failed:"),e.message),n<o&&(e.message.includes("CORS")||e.message.includes("fetch")||e.message.includes("NetworkError")||e.message.includes("Failed to fetch"))){let e=Math.min(1e3*Math.pow(2,n-1),5e3);console.log("[GoogleScript] Retrying in ".concat(e,"ms...")),await new Promise(t=>setTimeout(t,e));continue}throw e}throw t}o.d(t,{processDocumentAuto:function(){return n}})}}]);